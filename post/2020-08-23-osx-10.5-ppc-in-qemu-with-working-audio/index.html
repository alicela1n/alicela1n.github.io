<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.108.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>Working audio in Mac OS X 10.5 (or 10.4) PPC in QEMU&nbsp;&ndash;&nbsp;Alice's Digital Notebook</title><link rel=stylesheet href=../../css/core.min.a678a8fcd442e588a3ce898bbe660b06284fb8602630b560fbd95e9c1e45f45ca7ca327d2f4cdbb0d0a8da2f0ebf8084.css integrity=sha384-pnio/NRC5YijzomLvmYLBihPuGAmMLVg+9lenB5F9FynyjJ9L0zbsNCo2i8Ov4CE><meta name=twitter:card content="summary"><meta name=twitter:title content="Working audio in Mac OS X 10.5 (or 10.4) PPC in QEMU"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=../../><span class="site name">Alice's Digital Notebook</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=../../categories/>Categories</a><a class="nav item" href=../../tags/>Tags</a><a class="nav item" href=../../about/>About</a></nav></div></span></div><div class="site slogan"><span class=title>100% JavaScript-free</span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">Working audio in Mac OS X 10.5 (or 10.4) PPC in QEMU</h1><p class="article date">Aug 23, 2020</p></section><article class="article markdown-body"><h1 id=introduction><strong>Introduction</strong></h1><p>I&rsquo;ve been interested in old operating systems in a while, especially Apple ones. I love QEMU because it lets me emulate different (and a lot of obscure) operating systems and architectures that I otherwise would not have access to. This includes PPC Mac OS X, however one problem is that audio has never worked for me, since QEMU doesn&rsquo;t emulate a supported sound card.</p><h1 id=passing-through-an-audio-device><strong>Passing through an audio device?</strong></h1><p>Inconvenient, and I need to find one that is supported first. I&rsquo;d rather just avoid this at all costs.</p><h1 id=how-about-an-emulated-usb-audio-device><strong>How about an emulated USB audio device?</strong></h1><p>Turns out QEMU supports this! It&rsquo;s even documented in the <a href=https://wiki.qemu.org/Documentation/GuestOperatingSystems/MacOS10.4 target=_blank rel="noopener noreferrer">wiki</a>
. The audio won&rsquo;t sound great but it&rsquo;s better than nothing honestly. Just add the argument <code>-device ich9-usb-uhci1,id=newusb -device usb-audio,bus=newusb.0</code> and you&rsquo;re good to go. However there&rsquo;s one problem, it only works in OS X 10.4.0-10.4.3, 10.3 might be supported but I haven&rsquo;t tested.</p><h1 id=solution><strong>Solution</strong></h1><p>Only one that I can think of, and it involves downgrading a kext in your Mac OS X install. You need to extract the AppleUSBAudio.kext from Mac OS X 10.4.3.</p><h1 id=tiger><strong>Tiger</strong></h1><p>If you&rsquo;re running Mac OS X 10.4 in QEMU but haven&rsquo;t upgraded past 10.4.3 just yet, you can backup the AppleUSBAudio.kext from /System/Library/Extensions.</p><p>After this run the 10.4.11 upgrade installer. When it&rsquo;s done the audio will be broken.</p><p>Now install the kext with the following commands:</p><pre tabindex=0><code># rm -rf /System/Library/Extensions/AppleUSBAudio.kext
# cp -r AppleUSBAudio.kext /System/Library/Extensions/
# chmod -R 755 /System/Library/Extensions/AppleUSBAudio.kext
# chown -R root:wheel /System/Library/Extensions/AppleUSBAudio.kext
# rm -rf /System/Library/Extensions.mkext
# rm -rf /System/Library/Extensions.kextcache
</code></pre><p>Reboot, and audio should be working on Tiger.</p><h1 id=leopard><strong>Leopard</strong></h1><p>You will probably need either a Tiger install, might be able to extract the kext from the install DVD. Unknown if this will work on OS X 10.5.8 (I plan on testing later) but it certainly works on 10.5.1 which is what I&rsquo;m running.
Unfortunately, I won&rsquo;t be providing the kext due to copyright reasons, but you should be able to either extract it from an installation of 10.4.3 or get it through some other means.</p><p>After you have the kext install using the following commands:</p><pre tabindex=0><code># rm -rf /System/Library/Extensions/AppleUSBAudio.kext
# cp -r AppleUSBAudio.kext /System/Library/Extensions/
# chmod -R 755 /System/Library/Extensions/AppleUSBAudio.kext
# chown -R root:wheel /System/Library/Extensions/AppleUSBAudio.kext
# rm -rf /System/Library/Extensions.mkext
# rm -rf /System/Library/Extensions.kextcache
</code></pre><p>Reboot, and audio should be working on Leopard (at least 10.5.1).</p><p>Here&rsquo;s a video showing it working:
<a href="http://www.youtube.com/watch?v=B5fidnUY4Cc" title="Audio working in OS X 10.5 QEMU PPC" target=_blank rel="noopener noreferrer"><img src=http://img.youtube.com/vi/B5fidnUY4Cc/0.jpg alt></a></p></article><section class="article author"><img class=avatar src="https://avatars.githubusercontent.com/u/18562602?v=4" alt><p class=name>alicela1n</p><div class=bio>Magical girl from another dimension.</div><div class=details><a class=item href=https://github.com/alicela1n target=_blank rel="noopener noreferrer"><span class="iconfont icon-github"></span>&nbsp;alicela1n</a></div></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=../../post/2020-10-31-make-your-own-dotfiles-repo/><span class="iconfont icon-article"></span>Make your own dotfiles repo today</a></p><p><a class=link href=../../post/2020-08-22-just-systemd-nspawn-it/><span class="iconfont icon-article"></span>Need to use a different Linux distro? Just systemd-nspawn it!</a></p></section></div></section><section id=footer><div style=display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between><p style=flex-shrink:0>Â©2022 alicela1n</p><a rel=me href=https://mastodon.online/@alicela1n>Mastodon</a><p><span>Powered by </span><a href=https://gohugo.io target=_blank>Hugo</a><span> and the </span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p></div></section></body></html>